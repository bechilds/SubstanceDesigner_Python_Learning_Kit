教程地址：https://www.bilibili.com/video/BV1WR66YfEGR/?spm_id_from=333.1387.homepage.video_card.click&vd_source=47fbe7b51f8fba18dd7b0691365651af


后续可以把 init 中的功能拆解出来


这个 __init__.py 文件是一个非常全面的 Substance Designer Python 脚本开发入门教程，涵盖了从基础环境配置到高级 UI 交互的多个核心知识点。

以下是该文件中代码所教授内容的总结分析：

### 1. 基础环境与模块导入
*   **SDK 接入**: 演示了如何导入 `sd` 模块并获取核心上下文 (`sd.getContext()`) 和应用程序对象 (`app`)。
*   **类型系统**: 介绍了 SD 特有的数据类型模块，如 `sd.api.sdbasetypes` (float2, float4) 和 `sd.api.sdvaluefloat4` (颜色值封装)，解释了 SD API 中“值对象”与“基础数据”的区别（“钱包”与“现金”的比喻）。
*   **第三方库**: 展示了如何引入 `os` 模块处理路径，以及 `PySide2` 模块用于 GUI 开发。

### 2. 包与资源管理 (Package Management)
*   **获取包**: 使用 `pkg_mgr.getPackages()` 获取当前加载的所有包。
*   **加载/卸载包**:
    *   **方法2**: 演示了通过绝对路径加载 `.sbsar` 文件 (`loadUserPackage`)，以及如何正确卸载包 (`unloadUserPackage`)。强调了在卸载前保存路径信息的重要性。
    *   **方法3**: 展示了如何通过当前 Graph 的上下文动态获取路径，拼接相对路径来加载资源，这在插件开发中更具通用性。
*   **资源查找**: 使用 `findResourceFromUrl` 在包中查找特定资源。

### 3. 节点操作 (Node Operations)
*   **获取节点**:
    *   **方法4**: 演示了如何获取当前 Graph 中的所有节点 (`getNodes`) 和当前选中的节点 (`getCurrentGraphSelectedNodes`)。
*   **创建节点**:
    *   **方法3**: 实例化资源节点 (`newInstanceNode`)。
    *   **方法3**: 创建 SD 内置原子节点 (`newNode("sbs::compositing::blend")`)。
    *   **方法6**: 创建 Uniform 颜色节点。
*   **节点属性访问**:
    *   **方法5**: 详细讲解了如何遍历节点的属性 (`getProperties`)，区分了 `Annotation` (注释)、`Input` (输入)、`Output` (输出) 等不同类别。
    *   **方法9**: 展示了如何通过 ID 获取特定的属性对象 (`getPropertyFromId`)，如 "hue", "saturation"。

### 4. 节点连接与布局 (Connection & Layout)
*   **连接节点**:
    *   **方法6**: 使用 `newPropertyConnectionFromId` 将新创建节点的输入端口连接到选中节点的输出端口。
*   **位置管理**:
    *   **方法7**: 获取选中节点的位置 (`getPosition`)，并计算新节点的相对位置 (`setPosition`)，实现自动布局。

### 5. 属性值设置 (Property Values)
*   **设置数值**:
    *   **方法8**: 演示了如何设置颜色属性。重点在于流程：获取属性对象 -> 创建 `SDValueFloat4` 值对象 -> 调用 `setPropertyValue`。
    *   **方法9**: 演示了如何设置浮点数属性 (Hue/Saturation/Lightness)，使用 `SDValueFloat`。

### 6. UI 界面开发 (PySide2 Integration)
*   **菜单创建**:
    *   **方法10**: 完整展示了如何在 SD 主窗口菜单栏添加自定义菜单。
    *   **防重机制**: 实现了通过 `ObjectName` (`menu_id`) 查找并删除旧菜单的逻辑，防止插件重载时菜单重复堆叠。
    *   **Action 绑定**: 创建 `QAction` 并通过 `triggered.connect` 绑定回调函数。
*   **对话框开发**:
    *   创建了一个简单的 `QDialog`，并指定 SD 主窗口为父窗口 (`parent=main_window`)，确保窗口层级正确。

### 总结
这份代码实际上是一个**循序渐进的实战大纲**：
1.  先学会怎么**进门** (获取 Context)。
2.  再学会怎么**搬东西** (加载/卸载包)。
3.  然后学会怎么**操作机器** (创建、连接、修改节点)。
4.  最后学会怎么**装修控制台** (创建自定义菜单和窗口)。

它不仅提供了 API 的用法，还包含了很多工程实践中的细节（如防重菜单、相对路径加载、异常处理），是非常扎实的入门教材。


### 软件安装包中的SDK：核心定义
**SDK（Software Development Kit，软件开发工具包）**，是软件的开发者为了让其他开发者能够基于该软件进行**二次开发、功能扩展、集成对接**，而附带在软件安装包中的一套开发工具集合。
它和独立发布的SDK的区别是：独立SDK是单独的安装包，而软件安装包中的SDK是和软件本体绑定的，只有安装了该软件之后，这个SDK才能被正常使用。

---

### 软件安装包中SDK通常包含的内容
软件安装包中的SDK是官方封装好的工具集合，一般包含：
1.  **封装的开发库（Libraries）**
    是SDK的核心，是官方已经写好的可复用代码模块，开发者可以直接调用这些代码来使用该软件的功能，不需要从零开发。
    比如你使用的WPS，它的安装包中附带的SDK，会包含调用WPS文档编辑、表格计算功能的代码库，开发者不用自己写文档解析的代码，直接调用即可。
2.  **开发工具集**
    辅助开发的实用工具，比如调试工具（检查开发的扩展是否和软件兼容）、打包工具（把自己开发的插件打包成该软件支持的格式）、模拟器（部分平台类软件会提供，用于测试扩展效果）
3.  **开发文档**
    详细的使用说明，包括API调用规则、开发步骤指南、常见问题解答，是开发者上手的核心参考
4.  **示例项目/代码**
    官方提供的简单开发案例，比如一个简单的WPS插件示例，开发者可以直接参考修改，快速上手开发

---

### 软件安装包中SDK的作用
结合你关注的游戏开发、WPS使用的场景，它的作用可以理解为：
1.  **降低二次开发成本**：比如游戏客户端安装包中的SDK，开发者可以直接用它制作游戏的模组（MOD）、插件，不用自己从零开发游戏的核心功能
2.  **保证兼容性**：官方提供的SDK和软件本体的适配性最好，避免自己开发的扩展出现闪退、功能失效的问题
3.  **实现功能扩展/跨工具集成**：
    - 游戏场景：基于游戏SDK开发的MOD，可以给游戏添加新的道具、玩法
    - WPS场景：基于WPS SDK开发的插件，可以实现WPS和项目管理工具的跨应用数据同步，或者自定义WPS的专属功能
4.  **统一开发标准**：让所有开发者都使用相同的工具来扩展该软件，保证该软件的扩展生态更规范

---

### 补充：和API的区别（避免混淆）
很多人会把SDK和API搞混，简单区分：
- **API（应用程序编程接口）**：是SDK中的一部分，是开发者可以直接调用的「功能入口」，比如一个“获取WPS文档内容”的接口，就是一个API
- **SDK**：是包含API、开发工具、文档、示例的**完整工具集合**，API是SDK的“功能入口”，SDK是让开发者能够使用这些API的“工具箱”